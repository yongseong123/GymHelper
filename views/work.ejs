<!DOCTYPE html>
<html lang="ko" data-theme="gym-light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GymHelper - Work</title>
    <script>
      (function () {
        try {
          const key = "gymhelper-theme";
          const saved = localStorage.getItem(key);
          const valid = saved === "gym-light" || saved === "gym-dark";
          const preferredDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
          document.documentElement.setAttribute("data-theme", valid ? saved : (preferredDark ? "gym-dark" : "gym-light"));
        } catch (_error) {
          document.documentElement.setAttribute("data-theme", "gym-light");
        }
      })();
    </script>
    <link rel="stylesheet" href="/stylesheets/app.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/locales/ko.js"></script>
</head>
<body class="app-shell-bg">
    <div class="drawer min-h-screen lg:drawer-open">
        <input id="app-shell-drawer-work" type="checkbox" class="drawer-toggle">

        <div class="drawer-content flex min-h-screen flex-col">
            <header class="navbar border-b border-base-300 bg-base-100/90 px-4 backdrop-blur lg:px-6">
                <div class="flex-none lg:hidden">
                    <label for="app-shell-drawer-work" class="btn btn-square btn-ghost" aria-label="메뉴 열기">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M4 7h16M4 12h16M4 17h16" />
                        </svg>
                    </label>
                </div>

                <div class="flex-1 gap-3">
                    <a href="/work" class="text-lg font-semibold tracking-tight">GymHelper</a>
                    <span class="badge badge-primary badge-outline hidden sm:inline-flex">Dashboard</span>
                </div>

                <div class="flex items-center gap-2">
                    <div class="hidden items-center gap-2 rounded-box border border-base-300 bg-base-100 px-3 py-1 text-sm md:flex">
                        <span class="text-base-content/70">회원</span>
                        <span class="font-semibold" data-user-name>사용자</span>
                    </div>
                    <button type="button" class="btn btn-sm btn-ghost border border-base-300" data-theme-toggle>
                        <span class="hidden sm:inline">테마</span>
                        <span data-theme-label class="badge badge-ghost badge-sm">다크</span>
                    </button>
                    <button id="logoutBtn" class="btn btn-error btn-sm">로그아웃</button>
                </div>
            </header>

            <main class="flex-1 space-y-4 p-4 lg:space-y-5 lg:p-6">
                <section class="flex flex-wrap items-end justify-between gap-3 rounded-box border border-base-300 bg-base-100/85 p-4 shadow-sm">
                    <div>
                        <h1 class="text-2xl font-bold">운동 대시보드</h1>
                        <p class="mt-1 text-sm text-base-content/70">월간 통계, 부위별 추이, 캘린더를 한 화면에서 관리하세요.</p>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <button id="addWorkoutBtn" class="btn btn-primary">운동 기록</button>
                        <button id="myWorkoutsBtn" class="btn btn-secondary btn-outline">내 운동 모아보기</button>
                    </div>
                </section>

                <section class="grid gap-3 sm:grid-cols-2 xl:grid-cols-4">
                    <div class="kpi-stat">
                        <div class="stat-title">계정</div>
                        <div class="stat-value text-xl" data-user-name>사용자</div>
                        <div class="stat-desc">현재 로그인된 계정</div>
                    </div>
                    <div class="kpi-stat">
                        <div class="stat-title">주요 지표</div>
                        <div class="stat-value text-xl text-primary">Monthly</div>
                        <div class="stat-desc">월별 운동량 추이</div>
                    </div>
                    <div class="kpi-stat">
                        <div class="stat-title">캘린더</div>
                        <div class="stat-value text-xl text-secondary">Timeline</div>
                        <div class="stat-desc">운동 기록 날짜 확인</div>
                    </div>
                    <div class="kpi-stat">
                        <div class="stat-title">루틴 분석</div>
                        <div class="stat-value text-xl text-accent">Targets</div>
                        <div class="stat-desc">부위별 타겟 빈도 분석</div>
                    </div>
                </section>

                <section class="grid gap-4 2xl:grid-cols-[minmax(0,1.06fr)_minmax(0,0.94fr)]">
                    <div class="grid gap-4">
                        <article class="surface-card">
                            <div class="card-body p-4">
                                <div class="mb-3 flex flex-wrap items-center justify-between gap-2">
                                    <h2 class="card-title text-lg">월간 운동 통계</h2>
                                    <div class="flex flex-wrap gap-2">
                                        <select id="yearSelector" class="select select-bordered select-sm min-w-24"></select>
                                        <select id="monthSelector" class="select select-bordered select-sm min-w-24">
                                            <option value="1">1월</option>
                                            <option value="2">2월</option>
                                            <option value="3">3월</option>
                                            <option value="4">4월</option>
                                            <option value="5">5월</option>
                                            <option value="6">6월</option>
                                            <option value="7">7월</option>
                                            <option value="8">8월</option>
                                            <option value="9">9월</option>
                                            <option value="10">10월</option>
                                            <option value="11">11월</option>
                                            <option value="12">12월</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="relative h-[300px]">
                                    <canvas id="topGraphCanvas" width="400" height="200" class="!h-full !w-full"></canvas>
                                </div>
                            </div>
                        </article>

                        <article class="surface-card">
                            <div class="card-body p-4">
                                <div class="mb-3 flex flex-wrap items-center justify-between gap-2">
                                    <h2 class="card-title text-lg">부위별 타겟 추이</h2>
                                    <div id="targetSelector" class="flex flex-wrap gap-2">
                                        <button id="chestButton" class="btn btn-xs btn-outline">가슴</button>
                                        <button id="backButton" class="btn btn-xs btn-outline">등</button>
                                        <button id="shoulderButton" class="btn btn-xs btn-outline">어깨</button>
                                        <button id="legButton" class="btn btn-xs btn-outline">하체</button>
                                    </div>
                                </div>
                                <div class="relative h-[300px]">
                                    <canvas id="bottomGraphCanvas" width="400" height="200" class="!h-full !w-full"></canvas>
                                </div>
                            </div>
                        </article>
                    </div>

                    <article class="surface-card h-full min-h-[560px]">
                        <div class="card-body p-4">
                            <h2 class="card-title mb-2 text-lg">운동 캘린더</h2>
                            <div id="calendar" class="min-h-[620px] w-full"></div>
                        </div>
                    </article>
                </section>
            </main>
        </div>

        <div class="drawer-side z-40">
            <label for="app-shell-drawer-work" aria-label="메뉴 닫기" class="drawer-overlay"></label>
            <aside class="drawer-panel p-4">
                <div class="mb-6 px-2">
                    <a href="/work" class="text-xl font-bold tracking-tight text-primary">GymHelper</a>
                    <p class="mt-1 text-xs text-base-content/65">Workout Tracking Dashboard</p>
                </div>

                <ul class="menu gap-1 px-0">
                    <li><a href="/work" class="menu-link active">대시보드</a></li>
                    <li><a href="/community" class="menu-link">커뮤니티</a></li>
                    <li><a href="/accountSettings" class="menu-link">계정 설정</a></li>
                </ul>

                <div class="mt-6 rounded-box border border-base-300 bg-base-200/70 p-4 text-sm text-base-content/75">
                    <p class="font-semibold text-base-content">Tip</p>
                    <p class="mt-1">월/년 선택 후 그래프를 보면 루틴 변화를 더 쉽게 확인할 수 있습니다.</p>
                </div>
            </aside>
        </div>
    </div>

    <div id="myWorkoutsModal" class="modal" role="dialog" aria-modal="true">
        <div class="modal-box relative w-11/12 max-w-6xl border border-base-300 bg-base-100">
            <button type="button" class="close btn btn-sm btn-circle btn-ghost absolute right-4 top-4" aria-label="닫기">x</button>
            <h2 class="mb-4 text-xl font-semibold">내 운동 모아보기</h2>

            <div class="mb-4 flex flex-col gap-2 sm:flex-row sm:items-end">
                <label class="form-control w-full max-w-xs">
                    <span class="label-text pb-1 text-sm">날짜 선택</span>
                    <input type="date" id="filterDate" class="input input-bordered w-full">
                </label>
                <button id="filterDateBtn" class="btn btn-primary">날짜 검색</button>
            </div>

            <div class="overflow-x-auto rounded-box border border-base-300">
                <table id="myWorkoutsTable" class="table table-zebra table-pin-rows min-w-[860px]">
                    <thead>
                        <tr>
                            <th>운동 번호</th>
                            <th>운동 이름</th>
                            <th>무게</th>
                            <th>반복 횟수</th>
                            <th>운동 부위</th>
                            <th>운동 타겟</th>
                            <th>운동 타입</th>
                            <th>운동 날짜</th>
                            <th>수정</th>
                            <th>삭제</th>
                        </tr>
                    </thead>
                    <tbody id="myWorkoutsList"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="workoutModal" class="modal" role="dialog" aria-modal="true">
        <div class="modal-box relative w-11/12 max-w-2xl border border-base-300 bg-base-100">
            <button type="button" class="close btn btn-sm btn-circle btn-ghost absolute right-4 top-4" aria-label="닫기">x</button>
            <h2 class="mb-4 text-xl font-semibold">운동 기록 작성</h2>

            <form id="workoutForm" class="space-y-3">
                <label class="form-control w-full">
                    <span class="label-text pb-1 text-sm">운동 이름</span>
                    <input type="text" id="work_name" name="work_name" placeholder="운동 이름을 입력하세요" required class="input input-bordered w-full">
                </label>

                <label class="form-control w-full">
                    <span class="label-text pb-1 text-sm">무게 (kg)</span>
                    <input type="number" id="work_weight" name="work_weight" placeholder="운동 무게를 입력하세요 (선택)" class="input input-bordered w-full">
                </label>

                <label class="form-control w-full">
                    <span class="label-text pb-1 text-sm">반복 횟수</span>
                    <input type="number" id="work_count" name="work_count" placeholder="반복 횟수를 입력하세요" required class="input input-bordered w-full">
                </label>

                <label class="form-control w-full">
                    <span class="label-text pb-1 text-sm">운동 부위</span>
                    <select id="work_part" name="work_part" required class="select select-bordered w-full">
                        <option value="">선택해주세요</option>
                        <option value="가슴">가슴</option>
                        <option value="등">등</option>
                        <option value="어깨">어깨</option>
                        <option value="이두">이두</option>
                        <option value="삼두">삼두</option>
                        <option value="하체">하체</option>
                        <option value="복근">복근</option>
                        <option value="유산소">유산소</option>
                    </select>
                </label>

                <label class="form-control w-full">
                    <span class="label-text pb-1 text-sm">운동 타겟</span>
                    <select id="work_target" name="work_target" class="select select-bordered w-full">
                        <option value="">선택해주세요</option>
                    </select>
                </label>

                <label class="form-control w-full">
                    <span class="label-text pb-1 text-sm">운동 타입</span>
                    <select id="work_type" name="work_type" class="select select-bordered w-full">
                        <option value="">선택해주세요</option>
                        <option value="프리웨이트">프리웨이트</option>
                        <option value="머신">머신</option>
                    </select>
                </label>

                <label class="form-control w-full">
                    <span class="label-text pb-1 text-sm">운동 날짜</span>
                    <input type="date" id="work_day" name="work_day" required class="input input-bordered w-full">
                </label>

                <button type="button" id="submitWorkoutBtn" class="btn btn-primary mt-2 w-full">등록</button>
            </form>
        </div>
    </div>

    <script src="/javascripts/theme.js"></script>
    <script src="/javascripts/work.js"></script>
</body>
</html>

